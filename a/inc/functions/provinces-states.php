<?
$regions = array (
	"Canada"=>array (
		"abbrev"=>"CAN",
		"capital"=>"Ottawa",
		"regions"=>array(
			"Alberta"=>array (
				"abbrev"=>"AB",
				"capital"=>"Edmonton"
			),
			"British Columbia"=>array (
				"abbrev"=>"BC",
				"capital"=>"Victoria"
			),
			"Manitoba"=>array (
				"abbrev"=>"MB",
				"capital"=>"Winnipeg"
			),
			"New Brunswick"=>array (
				"abbrev"=>"NB",
				"capital"=>"Fredrickton"
			),
			"Newfoundland And Labrador"=>array (
				"abbrev"=>"NL",
				"capital"=>"St. John's"
			),				
			"Northwest Territories"=>array (
				"abbrev"=>"NT",
				"capital"=>"Yellowknife"
			),
			"Nova Scotia"=>array (
				"abbrev"=>"NS",
				"capital"=>"Halifax"
			),
			"Nunavut"=>array (
				"abbrev"=>"NU",
				"capital"=>"Iqaluit"
			),
			"Ontario"=>array (
				"abbrev"=>"ON",
				"capital"=>"Toronto"
			),
			"Prince Edward Island"=>array (
				"abbrev"=>"PE",
				"capital"=>"Charlottetown"
			),
			"Quebec"=>array (
				"abbrev"=>"QC",
				"capital"=>"Quebec City"
			),
			"Saskatchewan"=>array (
				"abbrev"=>"SK",
				"capital"=>"Saskatoon"
			),
			"Yukon"=>array (
				"abbrev"=>"YT",
				"capital"=>"Whitehorse"
			)
		)
	),
	"United States"=>array (
		"abbrev"=>"USA",
		"capital"=>"Washington",
		"regions"=>array(
			"Alabama"=>array (
				"abbrev"=>"AL",			
				"capital"=>"Montgomery"
			),
			"Alaska"=>array (
				"abbrev"=>"AK",
				"capital"=>"Juneau"
			),
			"American Samoa"=>array (
				"abbrev"=>"AS",
				"capital"=>"Pago Pago"
			),
			"Arizona"=>array (
				"abbrev"=>"AZ",			
				"capital"=>"Phoenix"
			),
			"Arkansas"=>array (
				"abbrev"=>"AR",
				"capital"=>"Little Rock"
			),				
			"California"=>array (
				"abbrev"=>"CA",			
				"capital"=>"Sacramento"
			),
			"Colorado"=>array (
				"abbrev"=>"CO",
				"capital"=>"Denver"
			),
			"Connecticut"=>array (
				"abbrev"=>"CT",			
				"capital"=>"Hartford"
			),
			"Delaware"=>array (
				"abbrev"=>"DE",			
				"capital"=>"Dover"
			),
			"District Of Columbia"=>array (
				"abbrev"=>"DC",			
				"capital"=>"Washington"
			),
			"Florida"=>array (
				"abbrev"=>"FL",			
				"capital"=>"Tallahassee"
			),
			"Georgia"=>array (
				"abbrev"=>"GA",			
				"capital"=>"Atlanta"
			),
			"Guam"=>array (
				"abbrev"=>"GU",			
				"capital"=>"Agana"
			),
			"Hawaii"=>array (
				"abbrev"=>"HI",			
				"capital"=>"Honolulu"
			),
			"Idaho"=>array (
				"abbrev"=>"ID",			
				"capital"=>"Boise"
			),
			"Illinois"=>array (
				"abbrev"=>"IL",			
				"capital"=>"Springfield"
			),
			"Indiana"=>array (
				"abbrev"=>"IN",			
				"capital"=>"Indianapolis"
			),
			"Iowa"=>array (
				"abbrev"=>"IA",
				"capital"=>"Des Moines"
			),
			"Kansas"=>array (
				"abbrev"=>"KS",
				"capital"=>"Topeka"
			),
			"Kentucky"=>array (
				"abbrev"=>"KY",
				"capital"=>"Frankfort"
			),
			"Louisiana"=>array (
				"abbrev"=>"LA",
				"capital"=>"Baton Rouge"
			),
			"Maine"=>array (
				"abbrev"=>"ME",
				"capital"=>"Augusta"
			),
			"Marshall Islands"=>array (
				"abbrev"=>"MH",
				"capital"=>"Majuro"
			),
			"Maryland"=>array (
				"abbrev"=>"MD",
				"capital"=>"Annapolis"
			),
			"Massachusetts"=>array (
				"abbrev"=>"MA",
				"capital"=>"Boston"
			),
			"Michigan"=>array (
				"abbrev"=>"MI",
				"capital"=>"Lansing"
			),
			"Micronesia"=>array (
				"abbrev"=>"FM",
				"capital"=>"Palikir"
			),
			"Minnesota"=>array (
				"abbrev"=>"MN",
				"capital"=>"Saint Paul"
			),
			"Minor Outlying Islands"=>array (
				"abbrev"=>"UM",
				"capital"=>"Washington"
			),
			"Mississippi"=>array (
				"abbrev"=>"MS",
				"capital"=>"Jackson"
			),
			"Missouri"=>array (
				"abbrev"=>"MO",
				"capital"=>"Jefferson City"
			),
			"Montana"=>array (
				"abbrev"=>"MT",
				"capital"=>"Helena"
			),
			"Nebraska"=>array (
				"abbrev"=>"NE",
				"capital"=>"Lincoln"
			),
			"Nevada"=>array (
				"abbrev"=>"NV",
				"capital"=>"Carson City"
			),
			"New Hampshire"=>array (
				"abbrev"=>"NH",
				"capital"=>"Concord"
			),
			"New Jersey"=>array (
				"abbrev"=>"NJ",			
				"capital"=>"Trenton"
			),
			"New Mexico"=>array (
				"abbrev"=>"NM",			
				"capital"=>"Santa Fe"
			),
			"New York"=>array (
				"abbrev"=>"NY",			
				"capital"=>"Albany"
			),
			"North Carolina"=>array (
				"abbrev"=>"NC",			
				"capital"=>"Raleigh"
			),
			"North Dakota"=>array (
				"abbrev"=>"ND",			
				"capital"=>"Bismarck"
			),
			"Northern Mariana Islands"=>array (
				"abbrev"=>"MP",			
				"capital"=>"Saipan"
			),
			"Ohio"=>array (
				"abbrev"=>"OH",			
				"capital"=>"Columbus"
			),
			"Oklahoma"=>array (
				"abbrev"=>"OK",					
				"capital"=>"Oklahoma City"
			),
			"Oregon"=>array (
				"abbrev"=>"OR",
				"capital"=>"Salem"
			),
			"Palau"=>array (
				"abbrev"=>"PW",			
				"capital"=>"Ngerulmud"
			),
			"Pennsylvania"=>array (
				"abbrev"=>"PA",
				"capital"=>"Harrisburg"
			),
			"Puerto Rico"=>array (
				"abbrev"=>"PR",
				"capital"=>"San Juan"
			),
			"Rhode Island"=>array (
				"abbrev"=>"RI",
				"capital"=>"Providence"
			),
			"South Carolina"=>array (
				"abbrev"=>"SC",			
				"capital"=>"Columbia"
			),
			"South Dakota"=>array (
				"abbrev"=>"SD",			
				"capital"=>"Pierre"
			),
			"Tennessee"=>array (
				"abbrev"=>"TN",			
				"capital"=>"Nashville"
			),
			"Texas"=>array (
				"abbrev"=>"TX",			
				"capital"=>"Austin"
			),
			"Utah"=>array (
				"abbrev"=>"UT",			
				"capital"=>"Salt Lake City"
			),
			"Vermont"=>array (
				"abbrev"=>"VT",			
				"capital"=>"Montpelier"
			),
			"Virginia"=>array (
				"abbrev"=>"VA",			
				"capital"=>"Richmond"
			),
			"Virgin Islands"=>array (
				"abbrev"=>"VI",			
				"capital"=>"Charlotte Amalie"
			),
			"Washington"=>array (
				"abbrev"=>"WA",			
				"capital"=>"Olympia"
			),
			"West Virginia"=>array (
				"abbrev"=>"WV",			
				"capital"=>"Charleston"
			),
			"Wisconsin"=>array (
				"abbrev"=>"WI",			
				"capital"=>"Madison"
			),
			"Wyoming"=>array (
				"abbrev"=>"WY",			
				"capital"=>"Cheyenne"
			)
		)
	)
);
		
function regionLookUp ($search, array $regArray) {		
	if (empty($search) || !is_string($search)) {return $regArray;}
	else {
		$nation = 0;
		foreach ($regArray as $country => $cinfo) { // loop through countries
			if ($country == $search) {
				$ret = array_slice($regArray, $nation, 1, true);
				return $ret;
			}
			else {
				foreach ($cinfo as $cproperty => $cvalue) { // loop through country info
					if ($cvalue == $search) {
						$ret = array_slice($regArray, $nation, 1, true);
						return $ret;
					}
					elseif ($cproperty == "regions") {
						$region = 0;
						foreach ($cvalue as $state => $sinfo) { // loop through states								
							if ($state == $search) {
								$ret = array_slice($regArray[$country]["regions"], $region, 1, true);
								return $ret;
							}
							else {
								foreach ($sinfo as $sproperty => $svalue) { // loop through state info										
									if ($svalue == $search) {
										$ret = array_slice($regArray[$country]["regions"], $region, 1, true);
										return $ret;
									}
								}
							}
							$region++;
						}
					}
				}
			}
			$nation++;
		}
	}
	return false;
}
//	Description: 	Function to search a multidimensional array of Country, State, and Capitol information and return all associated info
//	Parameters:		$search		-	Expects a string value containing the info to search for. Function returns false for non-string input
//					$regArray	-	Expects an array in the format of $regions, which is defined in this script. Other arrays can be used, but this
//									array is tested and confirmed working.
//	Returns: 		On a successful match, the function will return an array of information associated with the info that was searched for. Returns 
//					false when no matches found.

function countryCode ($search, array $regArray) {
	foreach ($regArray as $country => $cinfo) {
		if ($country == $search) {return $regArray[$country]['abbrev'];}
		else {
			foreach($cinfo as $cproperty => $cvalue) {
				if ($cvalue == $search) {return $regArray[$country]['abbrev'];}
				elseif ($cproperty == "regions") {
					foreach ($cvalue as $state => $sinfo) {
						if ($state == $search) {return $regArray[$country]['abbrev'];}
						else {
							foreach ($sinfo as $sproperty => $svalue) {
								if ($svalue == $search) {return $regArray[$country]['abbrev'];}
							}
						}
					}
				}
			}
		}
	}
	return false;
}
//	Description: 	Function to search a multidimensional array of Country, State, and Capitol information and return the associated country code
//	Parameters:		$search		-	Expects a string value containing the info to search for. Function returns false for non-string input
//					$regArray	-	Expects an array in the format of $regions, which is defined in this script. Other arrays can be used, but this
//									array is tested and confirmed working.
//	Returns: 		On a successful match, the function will return a string containing the country code associated with the info that was searched 
//					for. Returns false when no matches found.

function outputSelectOptions (array $regArray, $selected = "") {
	foreach ($regArray as $country => $cinfo) {
		$ret .= "<optgroup label=\"$country\">";
		foreach ($cinfo["regions"] as $state => $sinfo) {
			$ret .= "<option value=\"$sinfo[abbrev]\"";
			if (!empty($selected) && $selected == $sinfo['abbrev']) {$ret .= " selected=\"selected\"";}
			$ret.= ">$state</option>";
		}
		$ret .= "</optgroup>";
	}
	return $ret;
}
//	Description:	Function to output <option> tagss for a <select> input for each province/state in the array, in <optgroup>'s for each country.
//	Parameters:		$regArray	-	Expects an array in the format of $regions, which is defined in this script. Other arrays can be used, but this
//									array is tested and confirmed working.
//					$selected	-	OPTIONAL. Expects a string value containing the 2-letter province/state abbreviation to output as the 
//									selected option. Defaults to no selected option.
//	Returns:		A string with <optgroup>'s for each country, and <options> for each province/state in that country ?>